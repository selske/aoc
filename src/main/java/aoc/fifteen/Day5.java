package aoc.fifteen;

import java.io.BufferedReader;
import java.io.StringReader;
import java.util.function.Predicate;
import java.util.stream.Collectors;

public class Day5 {

    private static final String INPUT =
            "rthkunfaakmwmush\n" +
            "qxlnvjguikqcyfzt\n" +
            "sleaoasjspnjctqt\n" +
            "lactpmehuhmzwfjl\n" +
            "bvggvrdgjcspkkyj\n" +
            "nwaceixfiasuzyoz\n" +
            "hsapdhrxlqoiumqw\n" +
            "lsitcmhlehasgejo\n" +
            "hksifrqlsiqkzyex\n" +
            "dfwuxtexmnvjyxqc\n" +
            "iawwfwylyrcbxwak\n" +
            "mamtkmvvaeeifnve\n" +
            "qiqtuihvsaeebjkd\n" +
            "skerkykytazvbupg\n" +
            "kgnxaylpgbdzedoo\n" +
            "plzkdktirhmumcuf\n" +
            "pexcckdvsrahvbop\n" +
            "jpocepxixeqjpigq\n" +
            "vnsvxizubavwrhtc\n" +
            "lqveclebkwnajppk\n" +
            "ikbzllevuwxscogb\n" +
            "xvfmkozbxzfuezjt\n" +
            "ukeazxczeejwoxli\n" +
            "tvtnlwcmhuezwney\n" +
            "hoamfvwwcarfuqro\n" +
            "wkvnmvqllphnsbnf\n" +
            "kiggbamoppmfhmlf\n" +
            "ughbudqakuskbiik\n" +
            "avccmveveqwhnjdx\n" +
            "llhqxueawluwmygt\n" +
            "mgkgxnkunzbvakiz\n" +
            "fwjbwmfxhkzmwtsq\n" +
            "kzmtudrtznhutukg\n" +
            "gtvnosbfetqiftmf\n" +
            "aoifrnnzufvhcwuy\n" +
            "cldmefgeuwlbxpof\n" +
            "xdqfinwotmffynqz\n" +
            "pajfvqhtlbhmyxai\n" +
            "jkacnevnrxpgxqal\n" +
            "esxqayxzvortsqgz\n" +
            "glfoarwvkzgybqlz\n" +
            "xdjcnevwhdfsnmma\n" +
            "jyjktscromovdchb\n" +
            "pvguwmhdvfxvapmz\n" +
            "iheglsjvxmkzgdbu\n" +
            "lwjioxdbyhqnwekv\n" +
            "zcoguugygkwizryj\n" +
            "ogvnripxxfeqpxdh\n" +
            "hkvajhsbfnzsygbm\n" +
            "cnjqeykecopwabpq\n" +
            "wojjtbcjinoiuhsj\n" +
            "kpwpvgxbyzczdzjq\n" +
            "wrvhylisemlewgzk\n" +
            "uiezkmnhilfzahtm\n" +
            "mucteynnuxpxzmvt\n" +
            "zaiwbgxefusfhmst\n" +
            "apptbogpxivjwink\n" +
            "qryboarjtwjhjgjb\n" +
            "irehxupgyseaahzd\n" +
            "fobstqxguyubggoh\n" +
            "ysriumfghtxtfxwe\n" +
            "auchdmasvfeliptw\n" +
            "mztuhefcrnknyrdl\n" +
            "tyjmkhihbwabjtaa\n" +
            "yquzkdtgsljkaebw\n" +
            "almvdvofjtkyzbmd\n" +
            "emqftiuqqpdwwbrv\n" +
            "hrrhmqfpepvbawvw\n" +
            "atrkgykycvgxbpyb\n" +
            "dhthetnealksbdan\n" +
            "zzqafhgicubptiyo\n" +
            "qdtaieaziwhbttnw\n" +
            "kyskgapdgqrtrefw\n" +
            "edwzlpqztpydmdlr\n" +
            "awszjnlmvlyqsuvl\n" +
            "kcrtmtshtsgixvcp\n" +
            "jtaskgkijivbbkri\n" +
            "mmggfwapsetemiuj\n" +
            "itagrrnjbnmhgppd\n" +
            "uqmbezechbrpbnqq\n" +
            "nnyimvtascflpzsa\n" +
            "knqeimypkdttyudj\n" +
            "vgoiyvtvegwyxjjd\n" +
            "qubzdxsbecktzrho\n" +
            "zehojtvktsbbxijb\n" +
            "xepmjrekwcgoxyoh\n" +
            "bnptxnocbpbqbyeq\n" +
            "sfvynsywscbnymos\n" +
            "dsltfbpcmffbluba\n" +
            "kncrlzlmkikylppa\n" +
            "siwudrvmildgaozv\n" +
            "jhhefbvbvneqzvtc\n" +
            "lqjgztxitbuccqbp\n" +
            "himmwlbhjqednltt\n" +
            "vwognchyertnnfil\n" +
            "eejakhapkbodrntf\n" +
            "qxuijkkhhlskgrba\n" +
            "aankpfxxicfpllog\n" +
            "vuxykvljyqexfhrn\n" +
            "epgygflbxlbwybzq\n" +
            "zuxmwvetmvcszayc\n" +
            "xttwhfqmemgtjnkf\n" +
            "hftwldmivyfunfvl\n" +
            "bejlyxfamzliilrj\n" +
            "zkehazcxyyvtrxti\n" +
            "dsgafehmcfpycvgz\n" +
            "igremmqdojqdvwmb\n" +
            "swnjzvmhcslvkmiw\n" +
            "fchzbfbmtqtxmaef\n" +
            "xwjmyyrlznxrcytq\n" +
            "brwcwzpcvbwdrthl\n" +
            "fvrlridacsiojdmb\n" +
            "mhsturxdlmtxozvy\n" +
            "usxvqyrwywdyvjvz\n" +
            "gwazuslvmarfpnzm\n" +
            "rgkbudaqsnolbcqo\n" +
            "dpxvlbtavdhdedkj\n" +
            "nnqmjzejhodyfgyd\n" +
            "ozoazxkfhujgtzvy\n" +
            "psdgvhzdiwnuaxpl\n" +
            "tznkilxpogbzgijz\n" +
            "wnpytcseirtborhh\n" +
            "lhauurlfsmagfges\n" +
            "oqfbzixnlywkzwwy\n" +
            "yoehapoyjpakziom\n" +
            "vtjftdcsfdzbmtrn\n" +
            "zcshfnodiwixcwqj\n" +
            "wapbxpaxgjvtntkm\n" +
            "qfyypkyvblrtaenh\n" +
            "bsxhbxkovgukhcza\n" +
            "kitdmvpiwzdonoyy\n" +
            "slkbhxmehzavbdsf\n" +
            "dovzjouqkzkcmbkl\n" +
            "qpbigdcqkfnfkxvq\n" +
            "eaiaquhnesvtcdsv\n" +
            "mhbezlhqojdsuryj\n" +
            "dqprkkzxlghkoccx\n" +
            "xqepmorryeivhrhm\n" +
            "frwmrjpezwmjflvf\n" +
            "gjpfgwghodfslwlf\n" +
            "fzyvajisdjbhfthq\n" +
            "pvzxkxdscdbilrdb\n" +
            "mtaxmqcnagmplvnm\n" +
            "rlyafujuuydrqwnc\n" +
            "gvqvrcxwyohufehq\n" +
            "lmrkircgfrfusmfd\n" +
            "ovlpnkxcpimyaspb\n" +
            "xhyjremmqhdqywju\n" +
            "pxfczlhpzbypfarm\n" +
            "utjhprzhtggausyp\n" +
            "utzkkzlnyskjtlqh\n" +
            "cecbcnxpazvkedic\n" +
            "xwvoaggihrbhmijq\n" +
            "krredhmtwlfmyagw\n" +
            "lwfhxgbknhwudkzw\n" +
            "vyczyvuxzmhxmdmn\n" +
            "swcoaosyieqekwxx\n" +
            "waohmlfdftjphpqw\n" +
            "gaclbbfqtiqasijg\n" +
            "ybcyaxhluxmiiagp\n" +
            "xgtxadsytgaznndw\n" +
            "wzqhtjqpaihyxksm\n" +
            "fdwltsowtcsmsyhm\n" +
            "rpoelfbsararhfja\n" +
            "tswgdacgnlhzwcvz\n" +
            "xjgbhdlxllgeigor\n" +
            "ksgthvrewhesuvke\n" +
            "whgooqirdjwsfhgi\n" +
            "toztqrxzavxmjewp\n" +
            "hbkayxxahipxnrtl\n" +
            "lazimkmdnhrtflcu\n" +
            "ndoudnupbotwqgmr\n" +
            "niwuwyhnudxmnnlk\n" +
            "hlmihzlrpnrtwekr\n" +
            "wzkttdudlgbvhqnc\n" +
            "rfyzzgytifkqlxjx\n" +
            "skddrtwxcyvhmjtb\n" +
            "mljspkvjxbuyhari\n" +
            "xwkhozaoancnwaud\n" +
            "nookruxkdffeymdz\n" +
            "oiqfvpxmcplyfgoa\n" +
            "qoxggshmrjlzarex\n" +
            "lsroezewzkrwdchx\n" +
            "nkoonmvdydgzspcl\n" +
            "lygxeqztdqklabov\n" +
            "jempjyzupwboieye\n" +
            "hpdaqkhjiddzybly\n" +
            "cvcizjlnzdjfjlbh\n" +
            "vaaddsbkcgdjhbkj\n" +
            "pjxmtxoyrkmpnenf\n" +
            "ujqdvyqnkbusxlps\n" +
            "miyvzkzqploqaceb\n" +
            "gapcsbkulicvlnmo\n" +
            "xqpcyriqhjhaeqlj\n" +
            "ipumdjwlldzqhmgh\n" +
            "swdstecnzttmehxe\n" +
            "ucmqordmzgioclle\n" +
            "aywgqhmqlrzcxmqx\n" +
            "ptkgyitqanvjocjn\n" +
            "wcesxtmzbzqedgfl\n" +
            "rnetcouciqdesloe\n" +
            "chpnkwfdjikqxwms\n" +
            "onpyrjowcuzdtzfg\n" +
            "tydnqwaqwkskcycz\n" +
            "dhamguhmkjzzeduy\n" +
            "oecllwyrlvsyeeuf\n" +
            "gsukajpoewxhqzft\n" +
            "sgdnffdixtxidkih\n" +
            "pqqzjxzydcvwwkmw\n" +
            "wnjltltufkgnrtgm\n" +
            "hylaicyfrqwolnaq\n" +
            "ovfnugjjwyfjunkm\n" +
            "xknyzsebmqodvhcl\n" +
            "uwfmrjzjvvzoaraw\n" +
            "zaldjvlcnqbessds\n" +
            "zphvjuctrsksouvz\n" +
            "ceqbneqjwyshgyge\n" +
            "wmelhaoylbyxcson\n" +
            "nghuescieaujhgkj\n" +
            "dhjmflwwnskrdpph\n" +
            "exvanqpoofjgiubf\n" +
            "aidkmnongrzjhsvn\n" +
            "mdbtkyjzpthewycc\n" +
            "izctbwnzorqwcqwz\n" +
            "hrvludvulaopcbrv\n" +
            "mrsjyjmjmbxyqbnz\n" +
            "sjdqrffsybmijezd\n" +
            "geozfiuqmentvlci\n" +
            "duzieldieeomrmcg\n" +
            "ehkbsecgugsulotm\n" +
            "cymnfvxkxeatztuq\n" +
            "bacrjsgrnbtmtmdl\n" +
            "kbarcowlijtzvhfb\n" +
            "uwietqeuupewbjav\n" +
            "ypenynjeuhpshdxw\n" +
            "fwwqvpgzquczqgso\n" +
            "wjegagwkzhmxqmdi\n" +
            "vocvrudgxdljwhcz\n" +
            "nnytqwspstuwiqep\n" +
            "axapfrlcanzgkpjs\n" +
            "lklrjiszochmmepj\n" +
            "gxadfpwiovjzsnpi\n" +
            "qidsjxzgwoqdrfie\n" +
            "wgszciclvsdxxoej\n" +
            "kwewlmzxruoojlaq\n" +
            "ywhahockhioribnz\n" +
            "ucbqdveieawzucef\n" +
            "mdyyzmfoaxmzddfv\n" +
            "hsxnabxyqfzceijv\n" +
            "vivruyvbrtaqeebr\n" +
            "jxfeweptjtgvmcjc\n" +
            "mmypqxmpurhculwd\n" +
            "mpiaphksvctnryli\n" +
            "xqzqnuxmuzylkkun\n" +
            "fndmtefjxxcygtji\n" +
            "dnorqlldvzqprird\n" +
            "nutokyajmjpwjaqu\n" +
            "vlupfperqyqkjcaj\n" +
            "dgihjeokrphkpdnk\n" +
            "nvbdyrlheqzixuku\n" +
            "mhrkntnxvsmvrpka\n" +
            "kvhkyanlhhymwljf\n" +
            "fhipumtegqfgeqqw\n" +
            "vpfjgveycdefuabu\n" +
            "kzincljffncylcsf\n" +
            "tsezxymwmjtyegqw\n" +
            "wxhcdrqedkdcwxli\n" +
            "ueihvxviirnooomi\n" +
            "kfelyctfvwyovlyh\n" +
            "horzapuapgtvzizz\n" +
            "iiqkdpmfvhwwzmtj\n" +
            "rsaclclupiicstff\n" +
            "quwkkhrafypkaoum\n" +
            "gyrgkgmwqfkeudfe\n" +
            "noydhbqacwptyfmy\n" +
            "efwwuipzgtkwffhf\n" +
            "suyojcitomdxsduh\n" +
            "lbcxnsykojkufkml\n" +
            "zpglsvoutvzkgdep\n" +
            "usgrufyvgsbsmbpr\n" +
            "katrrwuhwvunjqor\n" +
            "btngwrpcxoyfbgbc\n" +
            "bxjscjdiowjrkpns\n" +
            "nwxvnfrnlkgqxvhf\n" +
            "ikhyqkvljucgdlag\n" +
            "xibnxsjopmxvflkl\n" +
            "mzplumcfivqcjqnz\n" +
            "jqflcxoxzlbwlxry\n" +
            "fcscvmfepdxrshxe\n" +
            "wlpffwunffklzbuc\n" +
            "emvrlqajjgwzfmle\n" +
            "rhaheurtzrfoqkyq\n" +
            "ifuuhpxmadaysfsx\n" +
            "ncyfvleyzqntpcoo\n" +
            "zeogmyaqccmtvokd\n" +
            "jqppbzebppdnpurn\n" +
            "xixarswxsiwjzgni\n" +
            "ezruwzajsoombphs\n" +
            "hmiqfeizyprielxf\n" +
            "jnaoxljnftymsfey\n" +
            "extgzrxzovlsixnf\n" +
            "yhyfmovvlrwoezsv\n" +
            "ffnybaolppuzpjym\n" +
            "pqowimdiusccaagn\n" +
            "jgceiosiihpjsmnu\n" +
            "hkoexeaopebktngx\n" +
            "njhzuvsygymejqav\n" +
            "yjkgcclgtvushcfk\n" +
            "gmbjxhnkkxlihups\n" +
            "pdlwysadiebsidjz\n" +
            "omrwmgzulfoaqros\n" +
            "ofvvgdezwvcffdcy\n" +
            "otytpuklhxcpxhgd\n" +
            "eyfaosxdauumvlux\n" +
            "mvdthjfstrlqlyuo\n" +
            "mdgdchgnlxaxspdm\n" +
            "bakjezmhbwqxzevd\n" +
            "msakswaphdwaodhg\n" +
            "vjcqscgdbnsxdllh\n" +
            "jjywaovewbuzreoj\n" +
            "nqvplhwacylifvwk\n" +
            "lpwmpixbxysmsign\n" +
            "flcvbpxrchcpbgcb\n" +
            "qjpkeuenenwawlok\n" +
            "bnqkflfmdmntctya\n" +
            "fzsgzpoqixvpsneq\n" +
            "icwfdisutoilejld\n" +
            "relchofohnkwbumi\n" +
            "aljalgdaqwhzhfwr\n" +
            "cahkvnwnbwhodpqs\n" +
            "dnrzeunxiattlvdm\n" +
            "nsmkhlrpwlunppjs\n" +
            "mqqsexlwfqnogwub\n" +
            "tfavelkqrtndpait\n" +
            "ooguafrnmprfxcnz\n" +
            "ntynkiordzxtwrqa\n" +
            "rkkyzlxekqqlkvym\n" +
            "ofxcivdnwcmgfnme\n" +
            "ywotqwbrqxlrnobh\n" +
            "nrbbiypwhrqihvev\n" +
            "flqsjixxtydheufs\n" +
            "lcfrfzypstrqctja\n" +
            "hyzbuzawuzjrynny\n" +
            "exfbywcnstebnvmq\n" +
            "vydzwnbmcihvqrnj\n" +
            "qmwqaaylinzrdmiw\n" +
            "lpxpztpvfggspeun\n" +
            "lhxmqqbracsuyrfm\n" +
            "zgkwsrabaseidbrw\n" +
            "yjlmbhbqsqgszsun\n" +
            "mqfzqtbxtuteabtd\n" +
            "izomzdmcqmfrevwd\n" +
            "iqijrlqurdwrkoln\n" +
            "fxhqzpgoxxjkkhql\n" +
            "oulwontmgrjeopnk\n" +
            "edaigfydjexvzzvj\n" +
            "vjhybiklxpxjqpwc\n" +
            "ypxfbfnpbmqmwtte\n" +
            "xzvcsgasztrxdzud\n" +
            "rpulqmobptfarboo\n" +
            "palacmdijxzzykrf\n" +
            "jmllwukplufohiby\n" +
            "dnswayomusiekfmy\n" +
            "sxbrjqtqgzzwhcfo\n" +
            "lylvndsgbnbqiejm\n" +
            "jaxxhoulxnxnaenr\n" +
            "nblissutfazbcpwn\n" +
            "zmlsjszzldvbiacr\n" +
            "kewojtlchfkclqwk\n" +
            "eqvfjasddggvfame\n" +
            "yibzqlvxtraxpdon\n" +
            "dgnbxsbmdrtyvaac\n" +
            "uoxrcxfimhgtxqhy\n" +
            "xfdxalrwcwudlviq\n" +
            "xmtbdklqptoswpwl\n" +
            "zezyopzdztdjerfl\n" +
            "xuzluhjsqvhytgbc\n" +
            "qdjtmeckispmgzki\n" +
            "phakupesplzmmmvc\n" +
            "gpuoqfffumzszybn\n" +
            "bhywxqkrrlwuebbw\n" +
            "ibvwgoyvelzenkzl\n" +
            "ncohvvbmiekbaksa\n" +
            "fzuvqzvxvdbeirrp\n" +
            "lshtzniokucwojjd\n" +
            "punrduvlnrulkium\n" +
            "gnfpikidnfobrrme\n" +
            "vxkvweekmnvkzgyl\n" +
            "rhydssudkcjlqgxn\n" +
            "cjtqvlaahohcgumo\n" +
            "jwzmfyinsfwecgcb\n" +
            "blpeseqhlzfilpuf\n" +
            "jvtpjkyokzcvagon\n" +
            "qjomincbcobjczpe\n" +
            "ugsyzkzgdhxtmsfz\n" +
            "hleaqgwzqjwajcra\n" +
            "coumfghptpnxvvov\n" +
            "hqpnbupnzwpdvgqd\n" +
            "cpouyodqxgviasem\n" +
            "lljvxeyozckifhfd\n" +
            "huqtnvutdyfgwtwa\n" +
            "yenlveuynmlmmymu\n" +
            "ojdyufkomxiwjmbf\n" +
            "spjzgvcwvzgffjkk\n" +
            "vxykmjhyvmhyssbp\n" +
            "tazdeqggfcjfvwwn\n" +
            "uumwcngwcytvpufx\n" +
            "avovuzkrevloneop\n" +
            "owczrtbnrvjfemkt\n" +
            "hzpugcanaxyvaokj\n" +
            "iishlodnxvjtgzyn\n" +
            "qosdonclrnxirham\n" +
            "eonqlnwevahydddg\n" +
            "ryqmnuikftlxuoqy\n" +
            "whqepbcwabzbthha\n" +
            "vekisvnwhgpyemxr\n" +
            "lrwxzoamnvpnlhap\n" +
            "ywepvqthnorfswjv\n" +
            "evqwvsoazmwyypjy\n" +
            "bgwoojddubppmjxf\n" +
            "jypkfrthzgtyeddi\n" +
            "tynabbhfjzkrqsju\n" +
            "adxstbfqheuqbcuk\n" +
            "gqwqiocdyqoiblrx\n" +
            "ybuddlyuskdlegxv\n" +
            "luwynbsmpgyeqsbr\n" +
            "ltyqgqoyljibqndo\n" +
            "jaedpajzphfybajh\n" +
            "epglnrxofptsqvmy\n" +
            "zjdpxkngfkstxbxh\n" +
            "ekegphcwanoickfu\n" +
            "cqvhuucvejqirvfs\n" +
            "uqudnnqumsqcgefo\n" +
            "qnzunermlnpcfflo\n" +
            "ovyxaniqaawzfuxx\n" +
            "djekxcezjowdhopq\n" +
            "bwtwbmdehrhpjnlk\n" +
            "nilsnlacerweikfa\n" +
            "hyrigsrmsrzcyaus\n" +
            "gvmdmgddduylmxic\n" +
            "ewzovdblhmjgjwsk\n" +
            "ojjfsknlonzguzlq\n" +
            "yjgfruvpjvlvrvvq\n" +
            "cyoryodwyhzwprbv\n" +
            "crsjclrurcquqgut\n" +
            "sjhfhobwtojxcmem\n" +
            "ibxfjudilmdeksea\n" +
            "uqbhdbjoeupyhbcz\n" +
            "uqbxigzxuxgmjgnw\n" +
            "jashafmtzrhswirg\n" +
            "dexiolovaucyooka\n" +
            "czjbwwnlwcoqnoiu\n" +
            "ojigosazigfhttjc\n" +
            "zfiqtgrqbmftknzn\n" +
            "dlzbmvmolssbqlzl\n" +
            "sgmchcurrutdtsmw\n" +
            "scdwjqsdohcdrwry\n" +
            "cgtdvecqwplpprxn\n" +
            "iiplenflfczaktwi\n" +
            "wmgnwfxfcjhyeiqg\n" +
            "giihshowtcatecvl\n" +
            "nqhzfincclumvkaz\n" +
            "kxstpzgdfvepionc\n" +
            "agbhxcijxjxerxyi\n" +
            "hmgfqevgdyvisyvs\n" +
            "tthakmvpowpvhtao\n" +
            "ottalcghygpaafbo\n" +
            "aplvozayycremgqg\n" +
            "dbjxlnaouxqtdpfz\n" +
            "peeyallzjsdvpalc\n" +
            "ndtdjyboixuyhfox\n" +
            "llabnbcobexfoldn\n" +
            "cweuvfnfyumbjvxr\n" +
            "ewkhhepaosalnvkk\n" +
            "pivyiwsiqpwhagyx\n" +
            "auzsnwdcerfttawt\n" +
            "grbfrekupciuzkrt\n" +
            "byfwzadtzrbndluf\n" +
            "lluypxjeljzquptk\n" +
            "pskwsnhqanemtfou\n" +
            "sxvrtqqjdjkfhhrm\n" +
            "ulsmqgmshvijyeqh\n" +
            "qigofesfhekoftkf\n" +
            "zhatniakqtqcxyqa\n" +
            "uuczvylgnxkenqee\n" +
            "mlitvtuxknihmisc\n" +
            "srrtrxdvcokpyfmz\n" +
            "osispuucklxcfkeb\n" +
            "vqhazlaulmnpipql\n" +
            "umkiueljberqhdig\n" +
            "knvpbkbvgoqzwprp\n" +
            "nbsocqikhuvsbloj\n" +
            "wjnpepjkzkednqbm\n" +
            "agbhmytsofuyqcor\n" +
            "gvogzhkkpxyfecko\n" +
            "ardafguxifeipxcn\n" +
            "yiajcskbgykyzzkw\n" +
            "sejunbydztyibnpq\n" +
            "dqrgfggwcnxeiygy\n" +
            "xnqqwilzfbhcweel\n" +
            "jjtifhlvmyfxajqi\n" +
            "gwszrpgpmbpiwhek\n" +
            "kydzftzgcidiohfd\n" +
            "efprvslgkhboujic\n" +
            "kecjdfwqimkzuynx\n" +
            "rildnxnexlvrvxts\n" +
            "dlnhjbqjrzpfgjlk\n" +
            "qluoxmzyhkbyvhub\n" +
            "crydevvrjfmsypbi\n" +
            "dosaftwumofnjvix\n" +
            "pwsqxrfwigeffvef\n" +
            "nzyfmnpwqyygjvfx\n" +
            "iccbckrkxlwjsjat\n" +
            "bmputypderxzrwab\n" +
            "bhuakynbwnlreixb\n" +
            "qmrzfyqjiwaawvvk\n" +
            "juvtixbkwyludftn\n" +
            "zapmjxmuvhuqlfol\n" +
            "paiwrqjhpjavuivm\n" +
            "tsepfbiqhhkbyriz\n" +
            "jpprewufiogxoygk\n" +
            "mmapyxbsugcsngef\n" +
            "pduhmgnepnpsshnh\n" +
            "aetndoqjvqyjrwut\n" +
            "fnfvlorhwpkkemhz\n" +
            "gedfidpwvoeazztl\n" +
            "beclvhospgtowaue\n" +
            "wsclsvthxustmczm\n" +
            "tjbxhnpniuikijhe\n" +
            "rhetyhvfcemponeg\n" +
            "mavonujurprbeexi\n" +
            "argbrpomztrdyasa\n" +
            "bzvtffbtygjxmkvh\n" +
            "maqyqkhsqgzfzvve\n" +
            "seeirbiynilkhfcr\n" +
            "wxmanwnozfrlxhwr\n" +
            "dieulypsobhuvswb\n" +
            "nxevassztkpnvxtb\n" +
            "jclxuynjsrezvlcy\n" +
            "xlolzyvgmwjsbmyf\n" +
            "tguzoeybelluxwxc\n" +
            "fkchoysvdoaasykz\n" +
            "cyynwbfcqpqapldf\n" +
            "rhifmzpddjykktuy\n" +
            "ndvufsyusbxcsotm\n" +
            "txutnzvdsorrixgg\n" +
            "qjoczhukbliojneu\n" +
            "ufhwujotncovjjsz\n" +
            "kclsgsdwcrxsycbr\n" +
            "yscwmlrdaueniiic\n" +
            "nxhivrovpkgsmugb\n" +
            "fdxqfyvwwvgeuqkv\n" +
            "femtamfylysohmpr\n" +
            "amsyzslvyxsoribh\n" +
            "nhmqxncwsonhgbcz\n" +
            "uomqsvcbpthlmcue\n" +
            "kxtfapcqrnjkkslj\n" +
            "xtieihonlfubeync\n" +
            "adpcjqxgydulchgj\n" +
            "cjynnzsmmujsxxpd\n" +
            "neeapmzweidordog\n" +
            "szoivgqyqwnyjsnk\n" +
            "uwgrtzaqezgphdcu\n" +
            "ptpgttqxocjwxohi\n" +
            "fhltebsizfwzpgpf\n" +
            "emmsazsidspkhgnh\n" +
            "dxcprkbcjeqxqzgn\n" +
            "tpxzqwxbzwigdtlt\n" +
            "afsmksnmzustfqyt\n" +
            "xyehnftstacyfpit\n" +
            "vcrfqumhjcmnurlw\n" +
            "rrznpjzcjgnugoch\n" +
            "gbxnzkwsjmepvgzk\n" +
            "jwobshgwerborffm\n" +
            "zmuvfkhohoznmifs\n" +
            "buyuwgynbtujtura\n" +
            "bevncenmpxfyzwtf\n" +
            "hqqtcrhzfsrcutjh\n" +
            "kbpzshllpiowepgc\n" +
            "alspewedcukgtvso\n" +
            "xvsvzzdcgjuvutrw\n" +
            "pmwulqraatlbuski\n" +
            "abuzsiinbueowpqn\n" +
            "oedruzahyfuchijk\n" +
            "avhcuhqqjuqkesoq\n" +
            "azqgplkzsawkvnhb\n" +
            "rjyoydogkzohhcvx\n" +
            "aezxwucqvqxuqotb\n" +
            "kxobnsjvzvenyhbu\n" +
            "nnjoiilshoavzwly\n" +
            "aijttlxjrqwaewgk\n" +
            "cvsaujkqfoixarsw\n" +
            "zngtoacpxcsplgal\n" +
            "qhkxliqtokvepcdv\n" +
            "aixihrtdmxkfvcqw\n" +
            "owbgdgdymxhhnoum\n" +
            "tajsagmruwzuakkd\n" +
            "ckrfduwmsodeuebj\n" +
            "alfdhuijuwyufnne\n" +
            "xpchlkijwuftgmnm\n" +
            "rwcrvgphistiihlg\n" +
            "xdaksnorrnkihreq\n" +
            "akeschycpnyyuiug\n" +
            "rgputhzsvngfuovz\n" +
            "lerknhznuxzdhvre\n" +
            "mqiqmyladulbkzve\n" +
            "csnmupielbbpyops\n" +
            "kwgrwgmhfzjbwxxz\n" +
            "npwtvbslvlxvtjsd\n" +
            "zxleuskblzjfmxgf\n" +
            "hexvporkmherrtrn\n" +
            "rhtdhcagicfndmbm\n" +
            "qhnzyuswqwoobuzz\n" +
            "dpvanjuofrbueoza\n" +
            "kjcqujmnhkjdmrrf\n" +
            "gholddsspmxtpybg\n" +
            "jihlvyqdyzkshfsi\n" +
            "zuviqmuqqfmtneur\n" +
            "kzexjowatvkohrtx\n" +
            "wgijnfhibsiruvnl\n" +
            "zevkrkmhsxmicijb\n" +
            "khxrcteqourjvoxa\n" +
            "ylpxlkcnenbxxtta\n" +
            "zrfsvctbojjkpvtw\n" +
            "nlzbudxibnmcrxbt\n" +
            "cqnscphbicqmyrex\n" +
            "ywvdohheukipshcw\n" +
            "riwatbvjqstubssf\n" +
            "idlztqqaxzjiyllu\n" +
            "sdpdgzemlqtizgxn\n" +
            "rjtbovqlgcgojyjx\n" +
            "fnfrfwujmjwdrbdr\n" +
            "osnppzzmrpxmdhtj\n" +
            "ljhwngclvydkwyoe\n" +
            "chwqkrkzrvjwarat\n" +
            "jmydkwpibkvmqlgs\n" +
            "zvhfmbxnlxtujpcz\n" +
            "jsnhsphowlqupqwj\n" +
            "fzhkkbpasthopdev\n" +
            "jerntjdsspdstyhf\n" +
            "gctwmaywbyrzwdxz\n" +
            "xemeaiuzlctijykr\n" +
            "xulrqevtbhplmgxc\n" +
            "yfejfizzsycecqpu\n" +
            "gboxrvvxyzcowtzm\n" +
            "lpvhcxtchwvpgaxp\n" +
            "wdiwucbdyxwnjdqf\n" +
            "qgwoqazzjlvnjrwj\n" +
            "prtlnkakjfqcjngn\n" +
            "fagvxsvjpuvqxniz\n" +
            "xacmxveueaakfbsm\n" +
            "ginvtonnfbnugkpz\n" +
            "qpvggsppewfzvwin\n" +
            "reoqnlzruyyfraxa\n" +
            "kolwtqhifjbbuzor\n" +
            "vrkcywvdhdprztww\n" +
            "ngdvyfmvjqhbzbxt\n" +
            "rooxeoilqzqjunmp\n" +
            "efxmdprtogtxgyqs\n" +
            "qrhjuqndgurcmwgu\n" +
            "ouitjprueefafzpl\n" +
            "kirdwcksqrbwbchp\n" +
            "fpumsmogojuywezo\n" +
            "lgjrgykywugzjees\n" +
            "xigioqcpjabpbdas\n" +
            "ewkhuprpqzikmeop\n" +
            "fgrgxsqeducigxvr\n" +
            "bclkursnqkzmjihl\n" +
            "jozidniwvnqhvsbc\n" +
            "oghcilcyozrmmpta\n" +
            "xbgmaungzcpasapi\n" +
            "iqowypfiayzbcvhv\n" +
            "opdehgwdgkocrgkf\n" +
            "zfzvdjeinlegcjba\n" +
            "vhakxvlcayuzukap\n" +
            "xyradgyiebpevnwe\n" +
            "eamhtflgedwyshkn\n" +
            "igteqdgchjeulfth\n" +
            "kwsfkigxzpbgdxod\n" +
            "vapnpsbdboiewpzp\n" +
            "wbuqhjsngxpqshen\n" +
            "vxxilouxuytitwgm\n" +
            "cpnwlkwnkeanqnet\n" +
            "wdmbtqvvlowftvgb\n" +
            "wjtmcecpyqzwpbqg\n" +
            "jnxmoxdhvsphcdeg\n" +
            "wabxfxpotoywwodn\n" +
            "mwbsoxzlqpqobvvh\n" +
            "coktshbyzjkxnwlt\n" +
            "rzhnggpslwzvyqrp\n" +
            "dgzuqbzarbutlkfx\n" +
            "wunajaiiwgijfvjh\n" +
            "uotdbcgmsvbsfqlb\n" +
            "kxdtlgmqbccjqldb\n" +
            "ngmjzjwvwbegehfr\n" +
            "cvpsabqfpyygwncs\n" +
            "wqluvqlhdhskgmzj\n" +
            "rbveperybfntcfxs\n" +
            "fbmoypqdyyvqyknz\n" +
            "zxpgzwnvmuvkbgov\n" +
            "yexcyzhyrpluxfbj\n" +
            "ltqaihhstpzgyiou\n" +
            "munhsdsfkjebdicd\n" +
            "plecvjctydfbanep\n" +
            "kjrxnnlqrpcieuwx\n" +
            "zbcdtcqakhobuscf\n" +
            "kgovoohchranhmsh\n" +
            "llxufffkyvuxcmfx\n" +
            "tgaswqyzqopfvxtw\n" +
            "kojcqjkdpzvbtjtv\n" +
            "xggdlkmkrsygzcfk\n" +
            "vvitpsnjtdqwyzhh\n" +
            "gcqjuwytlhxsecci\n" +
            "vbsghygcsokphnrg\n" +
            "vejqximdopiztjjm\n" +
            "hudqtwmwkviiuslp\n" +
            "vwswfvpcwwpxlyry\n" +
            "gxmfiehdxptweweq\n" +
            "qjmekjdcedfasopf\n" +
            "pqyxdxtryfnihphf\n" +
            "felnavctjjojdlgp\n" +
            "hbimufguekgdxdac\n" +
            "dhxhtnqgfczywxlr\n" +
            "pssottpdjxkejjrh\n" +
            "edieanguabapxyig\n" +
            "sciinanyqblrbzbb\n" +
            "irxpsorkpcpahiqi\n" +
            "qsxecaykkmtfisei\n" +
            "ivfwlvxlbnrzixff\n" +
            "hqxzzfulfxpmivcw\n" +
            "vvbpaepmhmvqykdg\n" +
            "cetgicjasozykgje\n" +
            "wuetifzdarhwmhji\n" +
            "gaozwhpoickokgby\n" +
            "eldnodziomvdfbuv\n" +
            "favpaqktqaqgixtv\n" +
            "twbcobsayaecyxvu\n" +
            "lzyzjihydpfjgqev\n" +
            "wnurwckqgufskuoh\n" +
            "fxogtycnnmcbgvqz\n" +
            "aetositiahrhzidz\n" +
            "dyklsmlyvgcmtswr\n" +
            "ykaxtdkjqevtttbx\n" +
            "kfmnceyxyhiczzjm\n" +
            "nnizopcndipffpko\n" +
            "yjmznhzyfinpmvkb\n" +
            "sljegcvvbnjhhwdd\n" +
            "zmkeadxlwhfahpwg\n" +
            "rwvcogvegcohcrmx\n" +
            "aguqwrfymwbpscau\n" +
            "vlusytjagzvsnbwe\n" +
            "smvzhburcgvqtklh\n" +
            "rfuprvjkhazrcxpv\n" +
            "megqlnoqmymcrclc\n" +
            "gvldhkewtmlwqvqv\n" +
            "awynhvtyziemnjoa\n" +
            "voprnvtnzspfvpeh\n" +
            "dhlguqwmunbbekih\n" +
            "goayirdhnjrfuiqi\n" +
            "eoghydfykxdslohz\n" +
            "chpippjykogxpbxq\n" +
            "hqbycjweqczwjwgf\n" +
            "pvefsrvwumrlvhmt\n" +
            "eghwdovaynmctktk\n" +
            "crwkxoucibumzawc\n" +
            "bzbtahvhkdigvvtj\n" +
            "bnbptgihhfubxhho\n" +
            "ddqmbwyfmfnjjaro\n" +
            "gvtswqyzazihctif\n" +
            "vmqctjpgadxztqqb\n" +
            "dgnndowtpeooaqqf\n" +
            "sxdvctfdtalufxty\n" +
            "ylgeexosibsmmckw\n" +
            "sxplpyskbpqnojvw\n" +
            "coarhxtsvrontyeg\n" +
            "fyoaurggjupvzvlv\n" +
            "jlyrkqsiwuggvjem\n" +
            "uwbsjoxonreuucyi\n" +
            "gihuqvwxovbgokes\n" +
            "dxzaaxupbcgnxcwf\n" +
            "gidrgmvyrlqqslve\n" +
            "csflmlvqmonoywpx\n" +
            "jkxkpixlythlacnk\n" +
            "ejkarcdkdslldugv\n" +
            "dbzmsusevohhjkmr\n" +
            "cbrqzualjpdtworc\n" +
            "kpgidqlmcbpfmmwu\n" +
            "zwghjuofexfowqam\n" +
            "ncdlxmcrsmsocetz\n" +
            "kfprzqacefifjkbd\n" +
            "swwzivrxulkhvldc\n" +
            "wgqejhigbjwunscp\n" +
            "rsstnwcyybfauqxu\n" +
            "qhngfxyhdqopyfgk\n" +
            "zrndpyyejsmqsiaj\n" +
            "xxknxwpvafxiwwjc\n" +
            "mmaahwgoiwbxloem\n" +
            "tabacndyodmpuovp\n" +
            "yriwomauudscvdce\n" +
            "duvyscvfidmtcugl\n" +
            "mgipxnqlfpjdilge\n" +
            "imeeqcdetjuhfjnw\n" +
            "dvkutrdofpulqkyh\n" +
            "jefvtlktxegpmbya\n" +
            "iyzudqgpvlzjfydh\n" +
            "giohapxnpaqayryd\n" +
            "qheqdprmnqlpztls\n" +
            "rdxhijmzegxkotoq\n" +
            "hdnmaspumdwnrcdz\n" +
            "wafpbgehbuzdgsnc\n" +
            "tbtrfztsferdmhsy\n" +
            "vusndcyjngtkrtmk\n" +
            "ilqblestzxebcifh\n" +
            "urfgjbjgzlrfsdlv\n" +
            "aptcdvpsqwleqttn\n" +
            "bigczjvzokvfofiw\n" +
            "zjnjeufonyqgkbpx\n" +
            "trcdebioegfqrrdi\n" +
            "jrdvdriujlmbqewt\n" +
            "jqrcmuxpwurdhaue\n" +
            "yjlermsgruublkly\n" +
            "zwarvgszuqeesuwq\n" +
            "xthhhqzwvqiyctvs\n" +
            "mzwwaxnbdxhajyyv\n" +
            "nclsozlqrjvqifyi\n" +
            "gcnyqmhezcqvksqw\n" +
            "deuakiskeuwdfxwp\n" +
            "tclkbhqqcydlgrrl\n" +
            "qbpndlfjayowkcrx\n" +
            "apjhkutpoiegnxfx\n" +
            "oaupiimsplsvcsie\n" +
            "sdmxrufyhztxzgmt\n" +
            "ukfoinnlbqrgzdeh\n" +
            "azosvwtcipqzckns\n" +
            "mydyeqsimocdikzn\n" +
            "itfmfjrclmglcrkc\n" +
            "swknpgysfscdrnop\n" +
            "shyyuvvldmqheuiv\n" +
            "tljrjohwhhekyhle\n" +
            "dayinwzuvzimvzjw\n" +
            "qgylixuuervyylur\n" +
            "klqqaiemurawmaaz\n" +
            "hdmzgtxxjabplxvf\n" +
            "xiivzelzdjjtkhnj\n" +
            "ktgplkzblgxwrnvo\n" +
            "gvbpyofzodnknytd\n" +
            "lqhlmnmhakqeffqw\n" +
            "ltzdbngrcxwuxecy\n" +
            "obxnfjeebvovjcjz\n" +
            "zexpwallpocrxpvp\n" +
            "tjpkkmcqbbkxaiak\n" +
            "qiedfixxgvciblih\n" +
            "qcxkhghosuslbyih\n" +
            "gnsfidwhzaxjufgm\n" +
            "xrghwgvyjakkzidw\n" +
            "tftftwedtecglavz\n" +
            "wquqczzkzqrlfngr\n" +
            "twibtkijpvzbsfro\n" +
            "bmplypdsvzuhrjxp\n" +
            "zanrfmestvqpwbuh\n" +
            "zonrhfqowyimcukm\n" +
            "kpvajjfmqpbhrjma\n" +
            "kujzluicngigjbtp\n" +
            "iusguantsrwxdjal\n" +
            "kwxeuylcnszswahw\n" +
            "visdhnkobxnemldu\n" +
            "rogeadmmaicwtabl\n" +
            "pxqycifbgevqudvs\n" +
            "osaiozyvlyddylqr\n" +
            "vffjxrolrpuxcatx\n" +
            "jbmsetccdrywssjd\n" +
            "qgxyhjfpbfifmvgc\n" +
            "npejgalglldxjdhs\n" +
            "mbbtqgmttastrlck\n" +
            "whapaqwdtpkropek\n" +
            "dulbdboxazfyjgkg\n" +
            "xaymnudlozbykgow\n" +
            "lebvqmxeaymkkfoy\n" +
            "bmicnfuubkregouj\n" +
            "dieatyxxxlvhneoj\n" +
            "yglaapcsnsbuvrva\n" +
            "bbpjaslqpzqcwkpk\n" +
            "xehuznbayagrbhnd\n" +
            "ikqmeovaurmqfuvr\n" +
            "ylyokwuzxltvxmgv\n" +
            "hqtfinrkllhqtoiz\n" +
            "pjmhtigznoaejifx\n" +
            "fqdbmowkjtmvvrmx\n" +
            "uvqtqfoulvzozfxv\n" +
            "rpajajukuxtchrjd\n" +
            "sznucejifktvxdre\n" +
            "ufvibsmoushmjbne\n" +
            "xirdqoshngthfvax\n" +
            "iafpkddchsgdqmzl\n" +
            "vmualmlduipvykzh\n" +
            "fnmuahmblwyceejb\n" +
            "ilsaapnswfoymiov\n" +
            "lenvylifraahaclv\n" +
            "cukqxlipuyxedqfh\n" +
            "zgwecslpniqvtvuz\n" +
            "cdcdfpsxuyrhsmag\n" +
            "dszjinhantnxgqra\n" +
            "ioimwotsgnjeacgt\n" +
            "dqcymnvjystbynhp\n" +
            "yibaudyfefbfgunx\n" +
            "cabslcvunjavqkbf\n" +
            "goymzvmgkvlsmugf\n" +
            "zxteiitpthzskjjx\n" +
            "agnxcnaqhjhlurzs\n" +
            "cvmgyxhhnykuxbmb\n" +
            "cgqmjexydmvgwxpp\n" +
            "sygjajofieojiuna\n" +
            "clpvxbrbjvqfbzvu\n" +
            "cbntswqynsdqnhyv\n" +
            "bztpbtwbefiotkfa\n" +
            "pnxccbgajvhyeybu\n" +
            "asyzrvgzumtuissa\n" +
            "facjyblvcqqginxa\n" +
            "rvwnucnbsvberxuv\n" +
            "ghrbeykzrxclasie\n" +
            "ekujtselepgjtaql\n" +
            "krtrzsmduhsifyiw\n" +
            "ticjswvsnyrwhpnt\n" +
            "clmjhsftkfjzwyke\n" +
            "lbxlcixxcztddlam\n" +
            "xhfeekmxgbloguri\n" +
            "azxqwlucwhahtvep\n" +
            "kitdjrwmockhksow\n" +
            "keznwwcusgbtvfrs\n" +
            "ljvzxoywcofgwajj\n" +
            "vebjnhnkcfzbhrcw\n" +
            "eqfcxkavstxcuels\n" +
            "ldattkyawjrvcido\n" +
            "bsqqeilshcwtqyil\n" +
            "foqqsxahfiozcqrw\n" +
            "liswfmuhzfbyzjhf\n" +
            "sulbdcyzmolapfbs\n" +
            "zuggzkelwxjpsgxb\n" +
            "betioxrgtnhpivcw\n" +
            "xmtbixstdipibhgs\n" +
            "ttvurgqmulryyaji\n" +
            "viobnljznzppfmxw\n" +
            "qlzabfopydtxrlet\n" +
            "tusvydegfxhaxolk\n" +
            "thoufvvfjferxhwp\n" +
            "cfyyzppfarjiilbs\n" +
            "jwmhxtgafkkgseqs\n" +
            "pqwuuaxbeklodwpt\n" +
            "vndyveahdiwgkjyx\n" +
            "ssrjgasfhdouwyoh\n" +
            "thbavfcisgvvyekf\n" +
            "yjdvxmubvqadgypa\n" +
            "tlbmcxaelkouhsvu\n" +
            "bonohfnlboxiezzr\n" +
            "rktlxcbkhewyvcjl\n" +
            "rsmoutcbcssodvsc\n" +
            "qszdratuxcrhsvoh\n" +
            "eypyfahpuzqwzwhi\n" +
            "yhkrleqmqlmwdnio\n" +
            "vpnvxusvmngsobmq\n" +
            "hkzyhopvxrsimzys\n" +
            "dblriiwnrvnhxykl\n" +
            "xkriqxkrprjwpncs\n" +
            "rcymltrbszhyhqti\n" +
            "mzbvneplsnpiztzn\n" +
            "vkqtnptgbqefvfoc\n" +
            "nwdtfiaozkcjtlax\n" +
            "crximadpvdaccrsm\n" +
            "lrbajafxwwnxvbei\n" +
            "rbexzesrytpwwmjf\n" +
            "stxwjarildpnzfpg\n" +
            "btamaihdivrhhrrv\n" +
            "acqbucebpaulpotl\n" +
            "dkjhzghxxtxgdpvm\n" +
            "rsbzwsnvlpqzyjir\n" +
            "mizypbwvpgqoiams\n" +
            "nvrslorjpqaasudn\n" +
            "wvexcpzmconqkbvk\n" +
            "rfwfumhjwzrvdzam\n" +
            "eaghdaqorkhdsmth\n" +
            "gtuntmpqaivosewh\n" +
            "nzlsmdgjrigghrmy\n" +
            "dhuvxwobpzbuwjgk\n" +
            "kkcuvbezftvkhebf\n" +
            "aeediumxyljbuyqu\n" +
            "rfkpqeekjezejtjc\n" +
            "wkzasuyckmgwddwy\n" +
            "eixpkpdhsjmynxhi\n" +
            "elrlnndorggmmhmx\n" +
            "ayxwhkxahljoxggy\n" +
            "mtzvvwmwexkberaw\n" +
            "evpktriyydxvdhpx\n" +
            "otznecuqsfagruls\n" +
            "vrdykpyebzyblnut\n" +
            "cnriedolerlhbqjy\n" +
            "uajaprnrrkvggqgx\n" +
            "xdlxuguloojvskjq\n" +
            "mfifrjamczjncuym\n" +
            "otmgvsykuuxrluky\n" +
            "oiuroieurpyejuvm";

    public static void main(final String[] args) {
        System.out.println(part1());
        System.out.println(part2());
    }

    private static Long part1() {
        return new BufferedReader(new StringReader(INPUT)).lines() //
                .filter(line -> line.matches(".*[aeiou].*[aeiou].*[aeiou].*")) //
                .filter(line -> line.matches(".*(.)\\1.*")) //
                .filter(((Predicate<String>) line -> line.matches(".*(ab|cd|pq|xy).*")).negate()) //
                .collect(Collectors.counting());
    }

    private static Long part2() {
        return new BufferedReader(new StringReader(INPUT)).lines() //
                .filter(line -> line.matches(".*(..).*\\1.*")) //
                .filter(line -> line.matches(".*(.).\\1.*")) //
                .collect(Collectors.counting());
    }

}
